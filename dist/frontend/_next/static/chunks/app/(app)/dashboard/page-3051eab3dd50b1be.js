(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{1986:(e,s,t)=>{"use strict";t.d(s,{d:()=>p});var a=t(5155),l=t(2115),r=t(4165),n=t(285),d=t(2346),i=t(6424),c=t(1689),o=t(5731),x=t(3013),m=t(1055),h=t(6102),u=t(8018),j=t(8856);function f(){return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"text-center mb-4",children:[(0,a.jsx)(j.E,{className:"h-6 w-3/4 mx-auto"}),(0,a.jsx)(j.E,{className:"h-4 w-full mt-2"}),(0,a.jsx)(j.E,{className:"h-4 w-1/2 mt-1 mx-auto"})]}),(0,a.jsx)(d.w,{className:"my-2 border-dashed"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.E,{className:"h-4 w-full"}),(0,a.jsx)(j.E,{className:"h-4 w-full"}),(0,a.jsx)(j.E,{className:"h-4 w-2/3"})]}),(0,a.jsx)(d.w,{className:"my-2 border-dashed"}),(0,a.jsx)("div",{className:"space-y-2 mt-4",children:Array.from({length:3}).map((e,s)=>(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,a.jsx)("div",{className:"col-span-6",children:(0,a.jsx)(j.E,{className:"h-4 w-full"})}),(0,a.jsx)("div",{className:"col-span-2 text-right",children:(0,a.jsx)(j.E,{className:"h-4 w-full"})}),(0,a.jsx)("div",{className:"col-span-4 text-right",children:(0,a.jsx)(j.E,{className:"h-4 w-full"})})]},s))}),(0,a.jsx)(d.w,{className:"my-2 border-dashed"}),(0,a.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,a.jsx)(j.E,{className:"h-5 w-1/2 ml-auto"}),(0,a.jsx)(j.E,{className:"h-6 w-1/3 ml-auto mt-2"})]})]})}function p(e){let{open:s,onOpenChange:t,transactionId:j}=e,p=l.useRef(null),{toast:N}=(0,c.dj)(),[b,v]=l.useState({}),[g,y]=l.useState(null),[w,E]=l.useState([]),[R,A]=l.useState(!1),[C,F]=l.useState(null);return l.useEffect(()=>{s&&j&&(A(!0),F(null),y(null),Promise.all([(0,o.oG)(j),(0,o.d$)(),(0,o.r5)()]).then(e=>{let[s,t,a]=e;y(s),E(t),v(a)}).catch(()=>{F("No se pudieron cargar los detalles del recibo."),N({variant:"destructive",title:"Error",description:"No se pudieron cargar los detalles del recibo."})}).finally(()=>{A(!1)}))},[s,j,N]),(0,a.jsx)(r.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(r.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(r.c7,{children:[(0,a.jsx)(r.L3,{children:"Recibo de Venta"}),(0,a.jsx)(r.rr,{children:"Detalles de la venta registrada. Puedes imprimir este recibo."})]}),(0,a.jsx)(i.F,{className:"max-h-[60vh]",children:(()=>{if(R)return(0,a.jsx)(f,{});if(C)return(0,a.jsx)("div",{className:"p-4 text-center text-red-500",children:C});if(!g)return(0,a.jsx)("div",{className:"p-4 text-center",children:"No hay datos de venta para mostrar."});let e=e=>w.find(s=>s.id===e),s=g.items.reduce((e,s)=>e+s.quantity*s.unitPrice,0),t=g.items.reduce((e,s)=>e+s.quantity*s.unitPrice*(s.tax_rate/100),0),l=s+t;return(0,a.jsxs)("div",{ref:p,className:"text-sm font-mono p-4",children:[(0,a.jsxs)("div",{className:"text-center mb-4",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:b.name||"Mi Tienda"}),(0,a.jsx)("p",{children:b.address||""}),(0,a.jsx)("p",{children:b.phone||""})]}),(0,a.jsx)(d.w,{className:"my-2 border-dashed"}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Factura #:"}),(0,a.jsx)("span",{children:g.document_number||"N/A"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Fecha:"}),(0,a.jsx)("span",{children:(0,x.GP)(new Date(g.transaction_date),"dd/MM/yyyy HH:mm",{locale:m.es})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Cliente:"}),(0,a.jsx)("span",{children:g.entity_name||"N/A"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"DNI/RIF:"}),(0,a.jsx)("span",{children:g.entity_document||"N/A"})]}),(0,a.jsx)(d.w,{className:"my-2 border-dashed"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2 font-bold",children:[(0,a.jsx)("div",{className:"col-span-6",children:"Producto"}),(0,a.jsx)("div",{className:"col-span-2 text-right",children:"Cant"}),(0,a.jsx)("div",{className:"col-span-4 text-right",children:"Subtotal"})]}),g.items.map((s,t)=>{let l=e(s.productId);return(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,a.jsx)("div",{className:"col-span-6 truncate",children:(null==l?void 0:l.name)||"N/A"}),(0,a.jsx)("div",{className:"col-span-2 text-right",children:s.quantity}),(0,a.jsx)("div",{className:"col-span-4 text-right",children:(s.quantity*s.unitPrice).toFixed(2)})]},"".concat(s.productId,"-").concat(t))})]}),(0,a.jsx)(d.w,{className:"my-2 border-dashed"}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Subtotal:"}),(0,a.jsxs)("span",{children:["$",s.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Impuestos:"}),(0,a.jsxs)("span",{children:["$",t.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-base mt-2",children:[(0,a.jsx)("span",{children:"TOTAL:"}),(0,a.jsxs)("span",{children:["$",l.toFixed(2)]})]})]})})()}),(0,a.jsx)(r.Es,{className:"sm:justify-end gap-2",children:(0,a.jsx)(h.Bc,{children:(0,a.jsxs)(h.m_,{children:[(0,a.jsx)(h.k$,{asChild:!0,children:(0,a.jsx)(n.$,{type:"button",variant:"outline",size:"icon",onClick:()=>{var e;let s=null==(e=p.current)?void 0:e.innerHTML;if(!s)return void N({variant:"destructive",title:"Error de Impresi\xf3n",description:"No se pudo encontrar el contenido del recibo."});let t=window.open("","_blank");t&&(t.document.write("\n        <html>\n            <head>\n            <title>Recibo de Venta</title>\n            <style>\n                body { font-family: 'Courier New', Courier, monospace; margin: 20px; }\n                .receipt-container { width: 300px; margin: 0 auto; }\n                .header { text-align: center; }\n                .item { display: flex; justify-content: space-between; }\n                .total { font-weight: bold; }\n                hr { border: none; border-top: 1px dashed #000; }\n            </style>\n            </head>\n            <body>".concat(s,"</body>\n        </html>")),t.document.close(),t.focus(),t.print(),t.close())},disabled:R||!!C||!g,children:(0,a.jsx)(u.A,{className:"h-4 w-4"})})}),(0,a.jsx)(h.ZI,{children:(0,a.jsx)("p",{children:"Imprimir"})})]})})})]})})}},2346:(e,s,t)=>{"use strict";t.d(s,{w:()=>d});var a=t(5155),l=t(2115),r=t(7489),n=t(9434);let d=l.forwardRef((e,s)=>{let{className:t,orientation:l="horizontal",decorative:d=!0,...i}=e;return(0,a.jsx)(r.b,{ref:s,decorative:d,orientation:l,className:(0,n.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",t),...i})});d.displayName=r.b.displayName},3750:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(5155),l=t(2115),r=t(6695),n=t(5127),d=t(6126),i=t(157);let c=(0,i.A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var o=t(4815),x=t(7374);let m=(0,i.A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var h=t(5731),u=t(9240),j=t(8856),f=t(1986);function p(){return(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(j.E,{className:"h-4 w-2/3"}),(0,a.jsx)(j.E,{className:"h-4 w-4"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)(j.E,{className:"h-8 w-1/2 mb-1"}),(0,a.jsx)(j.E,{className:"h-3 w-1/3"})]})]})}function N(){return(0,a.jsxs)(n.XI,{children:[(0,a.jsx)(n.A0,{children:(0,a.jsxs)(n.Hj,{children:[(0,a.jsx)(n.nd,{children:"Cliente"}),(0,a.jsx)(n.nd,{children:"Estado"}),(0,a.jsx)(n.nd,{children:"Fecha"}),(0,a.jsx)(n.nd,{className:"text-right",children:"Monto"})]})}),(0,a.jsx)(n.BF,{children:Array.from({length:3}).map((e,s)=>(0,a.jsxs)(n.Hj,{children:[(0,a.jsxs)(n.nA,{children:[(0,a.jsx)(j.E,{className:"h-5 w-24 mb-1"}),(0,a.jsx)(j.E,{className:"h-3 w-32"})]}),(0,a.jsx)(n.nA,{children:(0,a.jsx)(j.E,{className:"h-6 w-20 rounded-full"})}),(0,a.jsx)(n.nA,{children:(0,a.jsx)(j.E,{className:"h-4 w-24"})}),(0,a.jsx)(n.nA,{className:"text-right",children:(0,a.jsx)(j.E,{className:"h-4 w-16 ml-auto"})})]},s))})]})}function b(){let{isBackendReady:e,refetchKey:s}=(0,u.useBackendStatus)(),[t,i]=(0,l.useState)(null),[j,b]=(0,l.useState)([]),[v,g]=(0,l.useState)(!0),[y,w]=(0,l.useState)(null),[E,R]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(!e){g(!0),w("Esperando conexi\xf3n con el backend...");return}(async()=>{g(!0),w(null);try{let[e,s]=await Promise.all([(0,h.Zx)(),(0,h.OU)()]);i(e),b(s)}catch(e){w("Error: ".concat(e.message)),console.error(e)}finally{g(!1)}})()},[e,s]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"font-semibold text-lg md:text-2xl",children:"Panel de Control"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vista general de tu inventario."})]}),v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsx)(p,{}),(0,a.jsx)(p,{}),(0,a.jsx)(p,{}),(0,a.jsx)(p,{})]}),(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{children:"Ventas Recientes"}),(0,a.jsx)(r.BT,{children:"Un resumen de sus ventas m\xe1s recientes."})]}),(0,a.jsx)(r.Wu,{children:(0,a.jsx)(N,{})})]})]}):y?(0,a.jsx)("div",{className:"text-center py-10 text-red-500",children:y}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Ingresos Totales"}),(0,a.jsx)(c,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",null==t?void 0:t.totalRevenue.value.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[null==t?void 0:t.totalRevenue.change.toFixed(1),"% desde el mes pasado"]})]})]}),(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Ventas"}),(0,a.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["+",null==t?void 0:t.sales.value]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[null==t?void 0:t.sales.change.toFixed(1),"% desde el mes pasado"]})]})]}),(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Total de Productos"}),(0,a.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:null==t?void 0:t.totalProducts.value}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==t?void 0:t.totalProducts.change)>0?"+":"",null==t?void 0:t.totalProducts.change," desde la semana pasada"]})]})]}),(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Nuevos Clientes"}),(0,a.jsx)(m,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["+",null==t?void 0:t.newCustomers.value]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==t?void 0:t.newCustomers.change)>0?"+":"",null==t?void 0:t.newCustomers.change," desde ayer"]})]})]})]}),(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{children:"Ventas Recientes"}),(0,a.jsx)(r.BT,{children:"Un resumen de sus ventas m\xe1s recientes."})]}),(0,a.jsx)(r.Wu,{children:(0,a.jsxs)(n.XI,{children:[(0,a.jsx)(n.A0,{children:(0,a.jsxs)(n.Hj,{children:[(0,a.jsx)(n.nd,{children:"Cliente"}),(0,a.jsx)(n.nd,{children:"Estado"}),(0,a.jsx)(n.nd,{children:"Fecha"}),(0,a.jsx)(n.nd,{className:"text-right",children:"Monto"})]})}),(0,a.jsx)(n.BF,{children:j.map(e=>(0,a.jsxs)(n.Hj,{onClick:()=>R(e.id),className:"cursor-pointer hover:bg-muted/50",children:[(0,a.jsxs)(n.nA,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.customerName}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.customerEmail})]}),(0,a.jsx)(n.nA,{children:(0,a.jsx)(d.E,{variant:"Pending"===e.status?"secondary":"default",children:e.status})}),(0,a.jsx)(n.nA,{children:new Date(e.date).toLocaleDateString()}),(0,a.jsxs)(n.nA,{className:"text-right",children:["$",e.amount.toFixed(2)]})]},e.id))})]})})]})]})]}),(0,a.jsx)(f.d,{transactionId:E,open:null!==E,onOpenChange:e=>{e||R(null)}})]})}},5127:(e,s,t)=>{"use strict";t.d(s,{A0:()=>d,BF:()=>i,Hj:()=>c,XI:()=>n,nA:()=>x,nd:()=>o});var a=t(5155),l=t(2115),r=t(9434);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:(0,r.cn)("w-full caption-bottom text-sm",t),...l})})});n.displayName="Table";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("thead",{ref:s,className:(0,r.cn)("[&_tr]:border-b",t),...l})});d.displayName="TableHeader";let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tbody",{ref:s,className:(0,r.cn)("[&_tr:last-child]:border-0",t),...l})});i.displayName="TableBody",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tfoot",{ref:s,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...l})}).displayName="TableFooter";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tr",{ref:s,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...l})});c.displayName="TableRow";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("th",{ref:s,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...l})});o.displayName="TableHead";let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("td",{ref:s,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...l})});x.displayName="TableCell",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("caption",{ref:s,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",t),...l})}).displayName="TableCaption"},6102:(e,s,t)=>{"use strict";t.d(s,{Bc:()=>d,ZI:()=>o,k$:()=>c,m_:()=>i});var a=t(5155),l=t(2115),r=t(8082),n=t(9434);let d=r.Kq,i=r.bL,c=r.l9,o=l.forwardRef((e,s)=>{let{className:t,sideOffset:l=4,...d}=e;return(0,a.jsx)(r.UC,{ref:s,sideOffset:l,className:(0,n.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...d})});o.displayName=r.UC.displayName},6126:(e,s,t)=>{"use strict";t.d(s,{E:()=>d});var a=t(5155);t(2115);var l=t(2085),r=t(9434);let n=(0,l.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:s,variant:t,...l}=e;return(0,a.jsx)("div",{className:(0,r.cn)(n({variant:t}),s),...l})}},6424:(e,s,t)=>{"use strict";t.d(s,{F:()=>d});var a=t(5155),l=t(2115),r=t(7655),n=t(9434);let d=l.forwardRef((e,s)=>{let{className:t,children:l,...d}=e;return(0,a.jsxs)(r.bL,{ref:s,className:(0,n.cn)("relative overflow-hidden",t),...d,children:[(0,a.jsx)(r.LM,{className:"h-full w-full rounded-[inherit]",children:l}),(0,a.jsx)(i,{}),(0,a.jsx)(r.OK,{})]})});d.displayName=r.bL.displayName;let i=l.forwardRef((e,s)=>{let{className:t,orientation:l="vertical",...d}=e;return(0,a.jsx)(r.VM,{ref:s,orientation:l,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...d,children:(0,a.jsx)(r.lr,{className:"relative flex-1 rounded-full bg-border"})})});i.displayName=r.VM.displayName},7499:(e,s,t)=>{Promise.resolve().then(t.bind(t,3750))}},e=>{var s=s=>e(e.s=s);e.O(0,[130,134,131,655,841,240,441,684,358],()=>s(7499)),_N_E=e.O()}]);
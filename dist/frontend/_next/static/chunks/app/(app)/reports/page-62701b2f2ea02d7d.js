(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{4636:(e,a,t)=>{"use strict";t.d(a,{AM:()=>d,Wv:()=>c,hl:()=>i});var s=t(5155),l=t(2115),r=t(8176),n=t(9434);let d=r.bL,c=r.l9,i=l.forwardRef((e,a)=>{let{className:t,align:l="center",sideOffset:d=4,...c}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsx)(r.UC,{ref:a,align:l,sideOffset:d,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...c})})});i.displayName=r.UC.displayName},5127:(e,a,t)=>{"use strict";t.d(a,{A0:()=>d,BF:()=>c,Hj:()=>i,XI:()=>n,nA:()=>m,nd:()=>o});var s=t(5155),l=t(2115),r=t(9434);let n=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:a,className:(0,r.cn)("w-full caption-bottom text-sm",t),...l})})});n.displayName="Table";let d=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("thead",{ref:a,className:(0,r.cn)("[&_tr]:border-b",t),...l})});d.displayName="TableHeader";let c=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("tbody",{ref:a,className:(0,r.cn)("[&_tr:last-child]:border-0",t),...l})});c.displayName="TableBody",l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("tfoot",{ref:a,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...l})}).displayName="TableFooter";let i=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("tr",{ref:a,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...l})});i.displayName="TableRow";let o=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("th",{ref:a,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...l})});o.displayName="TableHead";let m=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("td",{ref:a,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...l})});m.displayName="TableCell",l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)("caption",{ref:a,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",t),...l})}).displayName="TableCaption"},5300:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(157).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},5511:(e,a,t)=>{"use strict";t.d(a,{V:()=>i});var s=t(5155);t(2115);var l=t(965),r=t(3158),n=t(3900),d=t(9434),c=t(285);function i(e){let{className:a,classNames:t,showOutsideDays:i=!0,...o}=e;return(0,s.jsx)(n.hv,{showOutsideDays:i,className:(0,d.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,d.cn)((0,c.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,d.cn)((0,c.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{className:a,...t}=e;return(0,s.jsx)(l.A,{className:(0,d.cn)("h-4 w-4",a),...t})},IconRight:e=>{let{className:a,...t}=e;return(0,s.jsx)(r.A,{className:(0,d.cn)("h-4 w-4",a),...t})}},...o})}i.displayName="Calendar"},7387:(e,a,t)=>{Promise.resolve().then(t.bind(t,7988))},7988:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>_});var s=t(5155),l=t(2115),r=t(3013),n=t(1055),d=t(4815),c=t(7374),i=t(1603),o=t(1920);let m=(0,t(157).A)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var x=t(5300),h=t(9434),u=t(6695),f=t(285),p=t(4636),j=t(5511),y=t(5057),g=t(1689),v=t(5127),b=t(4165),N=t(9240),w=t(5731);let S=[{type:"SALES",label:"Libro de Ventas",icon:d.A},{type:"PURCHASES",label:"Libro de Compras",icon:c.A},{type:"INVENTORY",label:"Inventario",icon:i.A}];function k(){let[e,a]=(0,l.useState)(new Date),[t,d]=(0,l.useState)(!1),[i,m]=(0,l.useState)(null),x=async()=>{if(!e)return void(0,g.Kf)("Error","Por favor, selecciona una fecha.");d(!0),m(null);try{let a=(0,r.GP)(e,"yyyy-MM-dd"),t=await (0,w.nV)(a);m({totalStock:t.totalStock,totalValue:t.totalValue})}catch(e){}finally{d(!1)}};return(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Resumen de Inventario Hist\xf3rico"}),(0,s.jsx)(u.BT,{children:"Calcula el valor y la cantidad total de tu inventario en una fecha espec\xedfica."})]}),(0,s.jsxs)(u.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[(0,s.jsxs)(p.AM,{children:[(0,s.jsx)(p.Wv,{asChild:!0,children:(0,s.jsxs)(f.$,{variant:"outline",className:"w-full sm:w-[280px] justify-start text-left font-normal",children:[(0,s.jsx)(o.A,{className:"mr-2 h-4 w-4"}),e?(0,r.GP)(e,"PPP",{locale:n.es}):(0,s.jsx)("span",{children:"Selecciona una fecha"})]})}),(0,s.jsx)(p.hl,{className:"w-auto p-0",children:(0,s.jsx)(j.V,{mode:"single",selected:e,onSelect:a,initialFocus:!0,disabled:e=>e>new Date})})]}),(0,s.jsx)(f.$,{onClick:x,disabled:t||!e,children:t?"Calculando...":"Calcular Resumen"})]}),i&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4",children:[(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(u.ZB,{className:"text-sm font-medium",children:"Unidades Totales en Stock"}),(0,s.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(u.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:i.totalStock.toLocaleString("es-VE")})})]}),(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(u.ZB,{className:"text-sm font-medium",children:"Valor Total del Inventario"}),(0,s.jsx)("span",{className:"text-muted-foreground font-bold text-lg",children:"$"})]}),(0,s.jsx)(u.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:i.totalValue.toLocaleString("es-VE",{minimumFractionDigits:2,maximumFractionDigits:2})})})]})]})]})]})}function _(){var e;let{isBackendReady:a,refetchKey:t}=(0,N.useBackendStatus)(),[d,c]=(0,l.useState)([]),[i,_]=(0,l.useState)(!0),[A,C]=(0,l.useState)(!1),[M,L]=(0,l.useState)(!1),[R,E]=(0,l.useState)(null),[P,G]=(0,l.useState)(null),[D,F]=(0,l.useState)("excel"),[V,T]=(0,l.useState)({from:new Date(new Date().setDate(1)),to:new Date}),[H,I]=(0,l.useState)(!1),[Z,B]=(0,l.useState)(!1),[O,z]=(0,l.useState)(null),W=(0,l.useCallback)(async()=>{if(!a){_(!0),E("Esperando conexi\xf3n con el backend...");return}try{_(!0),E(null);let e=await (0,w.Q4)();c(e)}catch(e){E(e.message)}finally{_(!1)}},[a]);(0,l.useEffect)(()=>{W()},[W,t]);let $=e=>{G(e),I(!0)},q=async()=>{if(!P||!(null==V?void 0:V.from)||!(null==V?void 0:V.to))return void(0,g.Kf)("Error de Validaci\xf3n","Por favor, seleccione un tipo de informe y un rango de fechas.");let e=(0,r.GP)(V.from,"yyyy-MM-dd"),a=(0,r.GP)(V.to,"yyyy-MM-dd");if("INVENTORY"===P&&"excel"===D){L(!0);try{await (0,w.D0)(e,a),(0,g.tP)("\xc9xito","La exportaci\xf3n a Excel ha comenzado. El archivo se descargar\xe1 en breve."),I(!1)}catch(e){}finally{L(!1)}return}C(!0);try{await (0,w.LU)(P,e,a),(0,g.tP)("\xc9xito","El informe se ha generado correctamente."),W(),I(!1)}catch(e){}finally{C(!1)}},U=async e=>{try{let a=await (0,w.vN)(e);z(a),B(!0)}catch(e){}},J=e=>new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"});return(0,s.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Generar Nuevo Informe"}),(0,s.jsx)(u.BT,{children:"Selecciona el tipo de informe que deseas generar."})]}),(0,s.jsx)(u.Wu,{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:S.map(e=>(0,s.jsx)(u.Zp,{className:"cursor-pointer transition-all hover:border-primary hover:shadow-lg",onClick:()=>$(e.type),children:(0,s.jsxs)(u.Wu,{className:"flex flex-col items-center justify-center p-8 gap-4",children:[(0,s.jsx)(e.icon,{className:"h-12 w-12 text-primary"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:e.label})]})},e.type))})]}),(0,s.jsx)(k,{}),(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Informes Generados"}),(0,s.jsx)(u.BT,{children:"Lista de informes generados previamente."})]}),(0,s.jsx)(u.Wu,{children:(0,s.jsxs)(v.XI,{children:[(0,s.jsx)(v.A0,{children:(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nd,{children:"ID"}),(0,s.jsx)(v.nd,{children:"Fecha de Generaci\xf3n"}),(0,s.jsx)(v.nd,{children:"Fecha de Inicio"}),(0,s.jsx)(v.nd,{children:"Fecha de Fin"}),(0,s.jsx)(v.nd,{children:(0,s.jsx)("span",{className:"sr-only",children:"Acciones"})})]})}),(0,s.jsx)(v.BF,{children:i?(0,s.jsx)(v.Hj,{children:(0,s.jsx)(v.nA,{colSpan:5,className:"text-center",children:"Cargando..."})}):R?(0,s.jsx)(v.Hj,{children:(0,s.jsx)(v.nA,{colSpan:5,className:"text-center text-destructive",children:R})}):0===d.length?(0,s.jsx)(v.Hj,{children:(0,s.jsx)(v.nA,{colSpan:5,className:"text-center",children:"No se encontraron informes generados."})}):d.map(e=>(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{className:"font-medium",children:e.id}),(0,s.jsx)(v.nA,{children:J(e.generated_at)}),(0,s.jsx)(v.nA,{children:(0,r.GP)(new Date(e.start_date),"dd/MM/yyyy")}),(0,s.jsx)(v.nA,{children:(0,r.GP)(new Date(e.end_date),"dd/MM/yyyy")}),(0,s.jsx)(v.nA,{className:"text-right",children:(0,s.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>U(e.id),children:"Ver"})})]},e.id))})]})})]}),(0,s.jsx)(b.lG,{open:H,onOpenChange:I,children:(0,s.jsxs)(b.Cf,{className:"sm:max-w-md",children:[(0,s.jsxs)(b.c7,{children:[(0,s.jsxs)(b.L3,{children:["Generar ",null==(e=S.find(e=>e.type===P))?void 0:e.label]}),(0,s.jsx)(b.rr,{children:"Selecciona el rango de fechas y el formato de salida."})]}),(0,s.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,s.jsxs)("div",{className:"grid gap-3",children:[(0,s.jsx)(y.J,{htmlFor:"date-range",children:"Rango de Fechas"}),(0,s.jsxs)(p.AM,{children:[(0,s.jsx)(p.Wv,{asChild:!0,children:(0,s.jsxs)(f.$,{id:"date-range",variant:"outline",className:(0,h.cn)("w-full justify-start text-left font-normal",!V&&"text-muted-foreground"),children:[(0,s.jsx)(o.A,{className:"mr-2 h-4 w-4"}),(null==V?void 0:V.from)?V.to?"".concat((0,r.GP)(V.from,"LLL dd, y",{locale:n.es})," - ").concat((0,r.GP)(V.to,"LLL dd, y",{locale:n.es})):(0,r.GP)(V.from,"LLL dd, y",{locale:n.es}):(0,s.jsx)("span",{children:"Seleccione un rango"})]})}),(0,s.jsx)(p.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(j.V,{initialFocus:!0,mode:"range",defaultMonth:null==V?void 0:V.from,selected:V,onSelect:T,numberOfMonths:1,locale:n.es})})]})]}),(0,s.jsxs)("div",{className:"grid gap-3",children:[(0,s.jsx)(y.J,{children:"Formato de Salida"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)(f.$,{variant:"excel"===D?"secondary":"outline",onClick:()=>F("excel"),className:"flex items-center gap-2",children:[(0,s.jsx)(m,{className:"h-4 w-4"}),"Excel"]}),(0,s.jsxs)(f.$,{variant:"pdf"===D?"secondary":"outline",onClick:()=>F("pdf"),className:"flex items-center gap-2",children:[(0,s.jsx)(x.A,{className:"h-4 w-4"}),"PDF"]})]})]})]}),(0,s.jsxs)(b.Es,{children:[(0,s.jsx)(f.$,{variant:"outline",onClick:()=>I(!1),children:"Cancelar"}),(0,s.jsx)(f.$,{onClick:q,disabled:A||M,children:A?"Generando...":M?"Exportando...":"Generar Informe"})]})]})}),(0,s.jsx)(b.lG,{open:Z,onOpenChange:B,children:(0,s.jsxs)(b.Cf,{className:"max-w-4xl h-[80vh] flex flex-col",children:[(0,s.jsxs)(b.c7,{children:[(0,s.jsxs)(b.L3,{children:["Detalle del Informe #",null==O?void 0:O.id]}),(0,s.jsxs)(b.rr,{children:["Generado el ",O?J(O.generated_at):""]})]}),(0,s.jsx)("div",{className:"flex-grow overflow-y-auto p-1 bg-muted rounded-md",children:(0,s.jsx)("pre",{className:"text-sm",children:O?JSON.stringify(JSON.parse(O.report_data),null,2):""})})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[130,134,131,748,240,441,684,358],()=>a(7387)),_N_E=e.O()}]);
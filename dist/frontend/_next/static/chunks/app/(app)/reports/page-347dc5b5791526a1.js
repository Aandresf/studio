(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{4636:(e,a,t)=>{"use strict";t.d(a,{AM:()=>d,Wv:()=>i,hl:()=>c});var r=t(5155),s=t(2115),n=t(8176),l=t(9434);let d=n.bL,i=n.l9,c=s.forwardRef((e,a)=>{let{className:t,align:s="center",sideOffset:d=4,...i}=e;return(0,r.jsx)(n.ZL,{children:(0,r.jsx)(n.UC,{ref:a,align:s,sideOffset:d,className:(0,l.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})})});c.displayName=n.UC.displayName},5127:(e,a,t)=>{"use strict";t.d(a,{A0:()=>d,BF:()=>i,Hj:()=>c,XI:()=>l,nA:()=>m,nd:()=>o});var r=t(5155),s=t(2115),n=t(9434);let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,n.cn)("w-full caption-bottom text-sm",t),...s})})});l.displayName="Table";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("thead",{ref:a,className:(0,n.cn)("[&_tr]:border-b",t),...s})});d.displayName="TableHeader";let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tbody",{ref:a,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...s})});i.displayName="TableBody",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tfoot",{ref:a,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tr",{ref:a,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});c.displayName="TableRow";let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("th",{ref:a,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});o.displayName="TableHead";let m=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("td",{ref:a,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});m.displayName="TableCell",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("caption",{ref:a,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"},5511:(e,a,t)=>{"use strict";t.d(a,{V:()=>c});var r=t(5155);t(2115);var s=t(965),n=t(3158),l=t(3900),d=t(9434),i=t(285);function c(e){let{className:a,classNames:t,showOutsideDays:c=!0,...o}=e;return(0,r.jsx)(l.hv,{showOutsideDays:c,className:(0,d.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,d.cn)((0,i.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,d.cn)((0,i.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{className:a,...t}=e;return(0,r.jsx)(s.A,{className:(0,d.cn)("h-4 w-4",a),...t})},IconRight:e=>{let{className:a,...t}=e;return(0,r.jsx)(n.A,{className:(0,d.cn)("h-4 w-4",a),...t})}},...o})}c.displayName="Calendar"},7387:(e,a,t)=>{Promise.resolve().then(t.bind(t,7988))},7988:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>S});var r=t(5155),s=t(2115),n=t(3013),l=t(1055),d=t(4815),i=t(7374),c=t(1603),o=t(1920);let m=(0,t(157).A)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var h=t(5300),x=t(9434),u=t(6695),f=t(285),p=t(4636),y=t(5511),j=t(5057),g=t(1689),b=t(5127),v=t(4165),N=t(9240),w=t(5731);let _=[{type:"SALES",label:"Libro de Ventas",icon:d.A},{type:"PURCHASES",label:"Libro de Compras",icon:i.A},{type:"INVENTORY",label:"Inventario",icon:c.A}];function S(){var e;let{isBackendReady:a,refetchKey:t}=(0,N.useBackendStatus)(),[d,i]=(0,s.useState)([]),[c,S]=(0,s.useState)(!0),[A,k]=(0,s.useState)(!1),[C,L]=(0,s.useState)(!1),[M,E]=(0,s.useState)(null),[R,G]=(0,s.useState)(null),[D,F]=(0,s.useState)("excel"),[I,P]=(0,s.useState)({from:new Date(new Date().setDate(1)),to:new Date}),[T,O]=(0,s.useState)(!1),[H,z]=(0,s.useState)(!1),[B,V]=(0,s.useState)(null),Z=(0,s.useCallback)(async()=>{if(!a){S(!0),E("Esperando conexi\xf3n con el backend...");return}try{S(!0),E(null);let e=await (0,w.Q4)();i(e)}catch(e){E(e.message)}finally{S(!1)}},[a]);(0,s.useEffect)(()=>{Z()},[Z,t]);let $=e=>{G(e),O(!0)},W=async()=>{if(!R||!(null==I?void 0:I.from)||!(null==I?void 0:I.to))return void(0,g.Kf)("Error de Validaci\xf3n","Por favor, seleccione un tipo de informe y un rango de fechas.");let e=(0,n.GP)(I.from,"yyyy-MM-dd"),a=(0,n.GP)(I.to,"yyyy-MM-dd");if("INVENTORY"===R&&"excel"===D){L(!0);try{await (0,w.D0)(e,a),(0,g.tP)("\xc9xito","La exportaci\xf3n a Excel ha comenzado. El archivo se descargar\xe1 en breve."),O(!1)}catch(e){}finally{L(!1)}return}k(!0);try{await (0,w.LU)(R,e,a),(0,g.tP)("\xc9xito","El informe se ha generado correctamente."),Z(),O(!1)}catch(e){}finally{k(!1)}},J=async e=>{try{let a=await (0,w.vN)(e);V(a),z(!0)}catch(e){}},U=e=>new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"});return(0,r.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,r.jsxs)(u.Zp,{children:[(0,r.jsxs)(u.aR,{children:[(0,r.jsx)(u.ZB,{children:"Generar Nuevo Informe"}),(0,r.jsx)(u.BT,{children:"Selecciona el tipo de informe que deseas generar."})]}),(0,r.jsx)(u.Wu,{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:_.map(e=>(0,r.jsx)(u.Zp,{className:"cursor-pointer transition-all hover:border-primary hover:shadow-lg",onClick:()=>$(e.type),children:(0,r.jsxs)(u.Wu,{className:"flex flex-col items-center justify-center p-8 gap-4",children:[(0,r.jsx)(e.icon,{className:"h-12 w-12 text-primary"}),(0,r.jsx)("p",{className:"text-lg font-semibold",children:e.label})]})},e.type))})]}),(0,r.jsxs)(u.Zp,{children:[(0,r.jsxs)(u.aR,{children:[(0,r.jsx)(u.ZB,{children:"Informes Generados"}),(0,r.jsx)(u.BT,{children:"Lista de informes generados previamente."})]}),(0,r.jsx)(u.Wu,{children:(0,r.jsxs)(b.XI,{children:[(0,r.jsx)(b.A0,{children:(0,r.jsxs)(b.Hj,{children:[(0,r.jsx)(b.nd,{children:"ID"}),(0,r.jsx)(b.nd,{children:"Fecha de Generaci\xf3n"}),(0,r.jsx)(b.nd,{children:"Fecha de Inicio"}),(0,r.jsx)(b.nd,{children:"Fecha de Fin"}),(0,r.jsx)(b.nd,{children:(0,r.jsx)("span",{className:"sr-only",children:"Acciones"})})]})}),(0,r.jsx)(b.BF,{children:c?(0,r.jsx)(b.Hj,{children:(0,r.jsx)(b.nA,{colSpan:5,className:"text-center",children:"Cargando..."})}):M?(0,r.jsx)(b.Hj,{children:(0,r.jsx)(b.nA,{colSpan:5,className:"text-center text-destructive",children:M})}):0===d.length?(0,r.jsx)(b.Hj,{children:(0,r.jsx)(b.nA,{colSpan:5,className:"text-center",children:"No se encontraron informes generados."})}):d.map(e=>(0,r.jsxs)(b.Hj,{children:[(0,r.jsx)(b.nA,{className:"font-medium",children:e.id}),(0,r.jsx)(b.nA,{children:U(e.generated_at)}),(0,r.jsx)(b.nA,{children:(0,n.GP)(new Date(e.start_date),"dd/MM/yyyy")}),(0,r.jsx)(b.nA,{children:(0,n.GP)(new Date(e.end_date),"dd/MM/yyyy")}),(0,r.jsx)(b.nA,{className:"text-right",children:(0,r.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>J(e.id),children:"Ver"})})]},e.id))})]})})]}),(0,r.jsx)(v.lG,{open:T,onOpenChange:O,children:(0,r.jsxs)(v.Cf,{className:"sm:max-w-md",children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsxs)(v.L3,{children:["Generar ",null==(e=_.find(e=>e.type===R))?void 0:e.label]}),(0,r.jsx)(v.rr,{children:"Selecciona el rango de fechas y el formato de salida."})]}),(0,r.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-3",children:[(0,r.jsx)(j.J,{htmlFor:"date-range",children:"Rango de Fechas"}),(0,r.jsxs)(p.AM,{children:[(0,r.jsx)(p.Wv,{asChild:!0,children:(0,r.jsxs)(f.$,{id:"date-range",variant:"outline",className:(0,x.cn)("w-full justify-start text-left font-normal",!I&&"text-muted-foreground"),children:[(0,r.jsx)(o.A,{className:"mr-2 h-4 w-4"}),(null==I?void 0:I.from)?I.to?"".concat((0,n.GP)(I.from,"LLL dd, y",{locale:l.es})," - ").concat((0,n.GP)(I.to,"LLL dd, y",{locale:l.es})):(0,n.GP)(I.from,"LLL dd, y",{locale:l.es}):(0,r.jsx)("span",{children:"Seleccione un rango"})]})}),(0,r.jsx)(p.hl,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(y.V,{initialFocus:!0,mode:"range",defaultMonth:null==I?void 0:I.from,selected:I,onSelect:P,numberOfMonths:1,locale:l.es})})]})]}),(0,r.jsxs)("div",{className:"grid gap-3",children:[(0,r.jsx)(j.J,{children:"Formato de Salida"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)(f.$,{variant:"excel"===D?"secondary":"outline",onClick:()=>F("excel"),className:"flex items-center gap-2",children:[(0,r.jsx)(m,{className:"h-4 w-4"}),"Excel"]}),(0,r.jsxs)(f.$,{variant:"pdf"===D?"secondary":"outline",onClick:()=>F("pdf"),className:"flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-4 w-4"}),"PDF"]})]})]})]}),(0,r.jsxs)(v.Es,{children:[(0,r.jsx)(f.$,{variant:"outline",onClick:()=>O(!1),children:"Cancelar"}),(0,r.jsx)(f.$,{onClick:W,disabled:A||C,children:A?"Generando...":C?"Exportando...":"Generar Informe"})]})]})}),(0,r.jsx)(v.lG,{open:H,onOpenChange:z,children:(0,r.jsxs)(v.Cf,{className:"max-w-4xl h-[80vh] flex flex-col",children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsxs)(v.L3,{children:["Detalle del Informe #",null==B?void 0:B.id]}),(0,r.jsxs)(v.rr,{children:["Generado el ",B?U(B.generated_at):""]})]}),(0,r.jsx)("div",{className:"flex-grow overflow-y-auto p-1 bg-muted rounded-md",children:(0,r.jsx)("pre",{className:"text-sm",children:B?JSON.stringify(JSON.parse(B.report_data),null,2):""})})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[130,134,131,421,240,441,684,358],()=>a(7387)),_N_E=e.O()}]);